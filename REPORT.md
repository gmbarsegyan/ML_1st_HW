# Отчет по ДЗ_1

### 1. Загрузка и первичный анализ данных

Загружены данные о продаже автомобилей: 6999 записей в тренировочной выборке и 1000 в тестовой. Датасет содержит 13 признаков: год выпуска, пробег, тип топлива, тип продавца, трансмиссия, количество владельцев, расход топлива, объём двигателя, мощность, крутящий момент и количество мест.

### 2. Обработка пропусков и дубликатов

В данных обнаружено 1170 явных дубликатов и пропуски в столбцах mileage, engine, max_power, torque, seats. Дубликаты удалены (осталось 5840 записей в train). Пропуски заполнены медианами, рассчитанными по тренировочной выборке, так как распределения признаков скошены вправо и медиана устойчивее к выбросам.

### 3. Преобразование признаков

Признаки mileage, engine, max_power содержали единицы измерения в строковом формате — они были очищены и приведены к числовому типу. Признак torque разделён на два: собственно крутящий момент (в Н·м) и обороты максимального момента (rpm). Значения в kgm переведены в Н * м.

### 4. Визуализация и анализ корреляций

Построены pairplot для визуализации попарных распределений и матрицы корреляций (Пирсона, Кендалла, phik). Выявлены сильные корреляции: между max_power и engine, между max_power и torque, между year и selling_price. Наиболее информативный признак для предсказания цены — максимальная мощность двигателя.

### 5. Обучение моделей

Данные объединены и разделены через train_test_split (70/30) с перемешиванием для устранения смещения по пробегу. Признаки стандартизированы с помощью StandardScaler.

Обучены модели:
- Линейная регрессия
- Lasso-регрессия с подбором гиперпараметров через GridSearchCV
- ElasticNet-регрессия с подбором гиперпараметров

## Полученные результаты

| Модель | R² | MSE |
|--------|-----|-----|
| Линейная регрессия | 0.587 | 1.47×10¹¹ |
| Lasso (alpha=1000) | 0.587 | 1.47×10¹¹ |
| ElasticNet (alpha=0.1, l1_ratio=0.7) | 0.583 | 1.48×10¹¹ |

Лучшая модель — Lasso с alpha=1000. Коэффициент детерминации R² = 0.587 означает, что модель объясняет около 59% дисперсии цены автомобиля.

## Что дало наибольший прирост качества

Наибольший вклад внесла правильная предобработка данных: очистка признаков от единиц измерения, разбиение torque на два признака, заполнение пропусков медианами. Стандартизация признаков позволила корректно интерпретировать веса модели. Перемешивание данных при разбиении устранило смещение (в исходном test было больше автомобилей с большим пробегом).

## Что не удалось

Качество модели (R² ≈ 0.59) не очень высокое. Линейная регрессия не может уловить все закономерности в данных. Возможно, добавление категориальных признаков (fuel, seller_type, transmission, owner) или применение нелинейных моделей улучшило бы результат. Также не использовался признак name, который содержит информацию о марке и модели автомобиля.

## Оценка Streamlit-приложения

### Удобство использования
Приложение простое и понятное. Есть два способа ввода данных: вручную через формы или загрузка CSV-файла. Результат предсказания выводится сразу после нажатия кнопки.

### Что получилось хорошо
- Наглядная визуализация распределений признаков
- Интерактивный выбор признака для построения scatter-plot
- Понятная визуализация весов модели с цветовой кодировкой

### Ограничения и проблемы
- Приложение работает только с предобработанными данными — если загрузить сырой CSV с единицами измерения, предсказание не сработает. При написании приложения предполагал, что данные будут даны в очищенном, числовом виде при загрузке CSV.
- Нет валидации введённых значений на адекватность (например, можно ввести отрицательный пробег)

### Планы на улучшение
- Добавить предобработку входных данных прямо в приложении
- Добавить возможность выбора модели для сравнения предсказаний
- Показывать похожие автомобили из обучающей выборки для сравнения цен
